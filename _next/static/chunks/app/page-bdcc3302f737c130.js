(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{477:()=>{},8218:(e,l,s)=>{Promise.resolve().then(s.bind(s,9742))},9742:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>p});var t=s(5155),a=s(2115),r=s(4060),n=s(8086);let o=(0,r.UU)("https://xxxxxxxxxxxxxxxx.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."),d=e=>{let{onSuccess:l}=e,[s,r]=(0,a.useState)(""),[d,i]=(0,a.useState)(""),[c,x]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[h,p]=(0,a.useState)("Treated"),[b,j]=(0,a.useState)(""),[g,y]=(0,a.useState)(null),[f,w]=(0,a.useState)(!1),[N,v]=(0,a.useState)(!1),[S,C]=(0,a.useState)(""),k=async e=>{if(e.preventDefault(),v(!1),C(""),!g){alert("Please select an image file.");return}w(!0);let t=null,a=null,f=null;try{var N,S;let e=await n.qg(g,{gps:!0});t=null!==(N=null==e?void 0:e.latitude)&&void 0!==N?N:null,a=null!==(S=null==e?void 0:e.longitude)&&void 0!==S?S:null,f=(null==e?void 0:e.DateTimeOriginal)?new Date(e.DateTimeOriginal).toISOString():null}catch(e){console.warn("EXIF data extraction failed:",e)}let k="".concat(Date.now(),"_").concat(g.name),{error:E}=await o.storage.from("canopeo-photos").upload(k,g);if(E){console.error("Image upload failed:",E),C("Image upload failed. Please try again."),w(!1);return}let Y="".concat("https://xxxxxxxxxxxxxxxx.supabase.co","/storage/v1/object/public/canopeo-photos/").concat(k),{error:_}=await o.from("photo_submissions").insert([{grower_name:s,dealer_name:d,crop_type:c,product_used:u,notes:b,upload_type:h,image_url:Y,latitude:t,longitude:a,timestamp:f}]);_?(console.error("Metadata insert failed:",_),C("Metadata submission failed.")):(v(!0),l({grower_name:s,dealer_name:d,crop_type:c,product_used:u,notes:b,upload_type:h,image_url:Y,latitude:t,longitude:a,timestamp:f}),r(""),i(""),x(""),m(""),p("Treated"),j(""),y(null)),w(!1)};return(0,t.jsxs)("form",{onSubmit:k,className:"max-w-xl mx-auto p-6 bg-white dark:bg-gray-900 shadow-md rounded text-black dark:text-white",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Submit Field Photo"}),(0,t.jsx)("label",{className:"block mb-2",children:"Grower / Cooperator / Knowledge Plot Name"}),(0,t.jsx)("input",{type:"text",value:s,onChange:e=>r(e.target.value),className:"w-full mb-4 p-2 border rounded bg-white dark:bg-gray-800",required:!0}),(0,t.jsx)("label",{className:"block mb-2",children:"Dealer / Account Manager Name"}),(0,t.jsx)("input",{type:"text",value:d,onChange:e=>i(e.target.value),className:"w-full mb-4 p-2 border rounded bg-white dark:bg-gray-800"}),(0,t.jsx)("label",{className:"block mb-2",children:"Crop Type"}),(0,t.jsxs)("select",{value:c,onChange:e=>x(e.target.value),className:"w-full mb-4 p-2 border rounded bg-white dark:bg-gray-800",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select Crop"}),(0,t.jsx)("option",{value:"Corn",children:"Corn"}),(0,t.jsx)("option",{value:"Soybeans",children:"Soybeans"}),(0,t.jsx)("option",{value:"Wheat",children:"Wheat"}),(0,t.jsx)("option",{value:"Sorghum",children:"Sorghum"}),(0,t.jsx)("option",{value:"Other",children:"Other"})]}),(0,t.jsx)("label",{className:"block mb-2",children:"Product Used"}),(0,t.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),className:"w-full mb-4 p-2 border rounded bg-white dark:bg-gray-800",required:!0}),(0,t.jsx)("label",{className:"block mb-2",children:"Upload Type"}),(0,t.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"w-full mb-4 p-2 border rounded bg-white dark:bg-gray-800",children:[(0,t.jsx)("option",{value:"Treated",children:"Treated"}),(0,t.jsx)("option",{value:"Untreated",children:"Untreated"})]}),(0,t.jsx)("label",{className:"block mb-2",children:"Optional Notes"}),(0,t.jsx)("textarea",{value:b,onChange:e=>j(e.target.value),className:"w-full mb-4 p-2 border rounded bg-white dark:bg-gray-800"}),(0,t.jsx)("label",{className:"block mb-2",children:"Photo Upload"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var l;return y((null===(l=e.target.files)||void 0===l?void 0:l[0])||null)},className:"mb-4",required:!0}),(0,t.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50",disabled:f,children:f?"Submitting...":"Submit"}),N&&(0,t.jsx)("p",{className:"text-green-600 mt-4",children:"✅ Submission successful!"}),S&&(0,t.jsxs)("p",{className:"text-red-600 mt-4",children:["❌ ",S]})]})};var i=s(3319);let c=e=>{let{data:l}=e,{grower_name:s,dealer_name:a,crop_type:r,product_used:n,upload_type:o,notes:d,image_url:c,latitude:x,longitude:u,timestamp:m}=l,h=m?(0,i.GP)(new Date(m),"yyyy-MM-dd HH:mm:ss"):"N/A";return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white dark:bg-gray-900 shadow-md rounded text-black dark:text-white",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-6 border-b pb-2",children:"Submission Summary"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600",children:"Grower / Cooperator"}),(0,t.jsx)("p",{children:s})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600",children:"Dealer / Account Manager"}),(0,t.jsx)("p",{children:a})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600",children:"Crop Type"}),(0,t.jsx)("p",{children:r})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600",children:"Product Used"}),(0,t.jsx)("p",{children:n})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600",children:"Upload Type"}),(0,t.jsx)("p",{children:o})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600",children:"Timestamp"}),(0,t.jsx)("p",{children:h})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600",children:"Latitude"}),(0,t.jsx)("p",{children:null!=x?x:"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600",children:"Longitude"}),(0,t.jsx)("p",{children:null!=u?u:"N/A"})]}),(0,t.jsxs)("div",{className:"sm:col-span-2",children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600",children:"Optional Notes"}),(0,t.jsx)("p",{children:d||"N/A"})]})]}),(0,t.jsxs)("div",{className:"border-t pt-4",children:[(0,t.jsx)("p",{className:"font-semibold text-yellow-600 mb-2",children:"Photo Preview"}),(0,t.jsx)("img",{src:c,alt:"Uploaded field",className:"w-full max-w-lg rounded shadow"})]})]})};var x=s(8890);let u=x.vv.create({page:{padding:30,fontSize:14,fontFamily:"Helvetica",backgroundColor:"#ffffff",color:"#000000"},heading:{fontSize:20,marginBottom:16,fontWeight:"bold",borderBottom:"1pt solid #000",paddingBottom:8},label:{fontWeight:"bold",color:"#b7791f",marginBottom:2},row:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:12},column:{width:"48%"},fullWidth:{marginBottom:12},box:{border:"1pt solid #ccc",borderRadius:4,padding:10,marginBottom:10},image:{marginTop:10,maxHeight:300}}),m=e=>{let{data:l}=e,{grower_name:s,dealer_name:a,crop_type:r,product_used:n,upload_type:o,notes:d,image_url:i,latitude:c,longitude:m,timestamp:h}=l;return(0,t.jsx)(x.yo,{children:(0,t.jsxs)(x.YW,{size:"A4",style:u.page,children:[(0,t.jsx)(x.EY,{style:u.heading,children:"YMS Crop Capture Submission Summary"}),(0,t.jsxs)(x.Ss,{style:u.box,children:[(0,t.jsxs)(x.Ss,{style:u.row,children:[(0,t.jsxs)(x.Ss,{style:u.column,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Grower / Cooperator:"}),(0,t.jsx)(x.EY,{children:s})]}),(0,t.jsxs)(x.Ss,{style:u.column,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Dealer / Account Manager:"}),(0,t.jsx)(x.EY,{children:a})]})]}),(0,t.jsxs)(x.Ss,{style:u.row,children:[(0,t.jsxs)(x.Ss,{style:u.column,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Crop Type:"}),(0,t.jsx)(x.EY,{children:r})]}),(0,t.jsxs)(x.Ss,{style:u.column,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Product Used:"}),(0,t.jsx)(x.EY,{children:n})]})]}),(0,t.jsxs)(x.Ss,{style:u.row,children:[(0,t.jsxs)(x.Ss,{style:u.column,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Upload Type:"}),(0,t.jsx)(x.EY,{children:o})]}),(0,t.jsxs)(x.Ss,{style:u.column,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Timestamp:"}),(0,t.jsx)(x.EY,{children:h||"N/A"})]})]}),(0,t.jsxs)(x.Ss,{style:u.row,children:[(0,t.jsxs)(x.Ss,{style:u.column,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Latitude:"}),(0,t.jsx)(x.EY,{children:null!=c?c:"N/A"})]}),(0,t.jsxs)(x.Ss,{style:u.column,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Longitude:"}),(0,t.jsx)(x.EY,{children:null!=m?m:"N/A"})]})]}),(0,t.jsxs)(x.Ss,{style:u.fullWidth,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Optional Notes:"}),(0,t.jsx)(x.EY,{children:d||"N/A"})]})]}),i&&(0,t.jsxs)(x.Ss,{style:u.fullWidth,children:[(0,t.jsx)(x.EY,{style:u.label,children:"Photo Preview:"}),(0,t.jsx)(x._V,{style:u.image,src:i})]})]})})},h=e=>{let{data:l}=e;return(0,t.jsx)("div",{className:"mt-4 flex justify-end",children:(0,t.jsx)(x.XP,{document:(0,t.jsx)(m,{data:l}),fileName:"YMS_Crop_Capture_Submission.pdf",className:"bg-green-700 hover:bg-green-800 text-white font-semibold py-2 px-4 rounded",children:e=>{let{loading:l}=e;return l?"Preparing PDF...":"Download PDF Summary"}})})};function p(){let[e,l]=(0,a.useState)(null);return(0,t.jsxs)("main",{className:"min-h-screen bg-gray-100 dark:bg-gray-950 text-gray-900 dark:text-white p-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center",children:"YMS Crop Capture App"}),(0,t.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,t.jsx)(d,{onSuccess:e=>l(e)}),e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c,{data:e}),(0,t.jsx)("div",{className:"mt-6 text-center",children:(0,t.jsx)(h,{data:e})})]})]})]})}}},e=>{var l=l=>e(e.s=l);e.O(0,[247,788,746,792,648,441,684,358],()=>l(8218)),_N_E=e.O()}]);